(function(){"use strict";var e={5998:function(e,t,a){var o=a(5130),n=a(6768);const r={id:"app"};function s(e,t,a,o,s,l){const i=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.bF)(i)])}var l={name:"App"},i=a(1241);const d=(0,i.A)(l,[["render",s]]);var u=d,c=a(1387);const p={class:"login"};function m(e,t,a,r,s,l){return(0,n.uX)(),(0,n.CE)("div",p,[t[4]||(t[4]=(0,n.Lk)("h2",null,"Login",-1)),(0,n.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>r.login&&r.login(...e)),["prevent"]))},[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),type:"email",placeholder:"Email",required:""},null,512),[[o.Jo,r.email]]),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),type:"password",placeholder:"Password",required:""},null,512),[[o.Jo,r.password]]),t[3]||(t[3]=(0,n.Lk)("button",{type:"submit"},"Login",-1))],32)])}a(4114);var h=a(144),g=a(782),f={setup(){const e=(0,g.Pj)(),t=(0,c.rd)(),a=(0,h.KR)(""),o=(0,h.KR)(""),n=async()=>{try{await e.dispatch("login",{email:a.value,password:o.value}),alert("Login successful!"),t.push("/dashboard")}catch(n){alert("Login failed! Please check your credentials."),console.error(n)}};return{email:a,password:o,login:n}}};const w=(0,i.A)(f,[["render",m]]);var y=w;const v={class:"login"};function k(e,t,a,r,s,l){return(0,n.uX)(),(0,n.CE)("div",v,[t[4]||(t[4]=(0,n.Lk)("h2",null,"Register",-1)),(0,n.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>r.login&&r.login(...e)),["prevent"]))},[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),type:"email",placeholder:"Email",required:""},null,512),[[o.Jo,s.email]]),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),type:"password",placeholder:"Password",required:""},null,512),[[o.Jo,s.password]]),t[3]||(t[3]=(0,n.Lk)("button",{type:"submit"},"Login",-1))],32)])}var b={data(){return{email:"",password:""}},setup(){const e=(0,g.Pj)(),t=(0,c.rd)(),a=async()=>{try{await e.dispatch("login",{email:this.email,password:this.password}),t.push("/dashboard")}catch(a){alert("Login failed!")}};return{login:a}}};const L=(0,i.A)(b,[["render",k]]);var C=L,E=a(4232);const M={key:0,class:"loading"},D={key:1,class:"empty"},F={key:2};function O(e,t,a,o,r,s){const l=(0,n.g2)("FileUpload"),i=(0,n.g2)("Map");return(0,n.uX)(),(0,n.CE)("div",null,[t[1]||(t[1]=(0,n.Lk)("h1",null,"User Dashboard",-1)),(0,n.bF)(l,{onFileUploaded:s.fetchDatasets},null,8,["onFileUploaded"]),r.loading?((0,n.uX)(),(0,n.CE)("div",M,"Loading datasets...")):0===r.datasets.length?((0,n.uX)(),(0,n.CE)("div",D,"No datasets uploaded yet.")):((0,n.uX)(),(0,n.CE)("div",F,[t[0]||(t[0]=(0,n.Lk)("h2",null,"Uploaded Datasets:",-1)),(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.datasets,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t},(0,E.v_)(e.name),1)))),128))]),(0,n.bF)(i,{datasets:r.datasets},null,8,["datasets"])]))])}a(1454);const S={key:0,style:{color:"red"}};function U(e,t,a,o,r,s){return(0,n.uX)(),(0,n.CE)("div",null,[t[1]||(t[1]=(0,n.Lk)("h3",null,"Upload GeoJSON/KML",-1)),(0,n.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>s.uploadFile&&s.uploadFile(...e)),accept:".geojson,.kml"},null,32),r.errorMessage?((0,n.uX)(),(0,n.CE)("p",S,(0,E.v_)(r.errorMessage),1)):(0,n.Q3)("",!0)])}var P=a(4373),A={data(){return{errorMessage:null}},methods:{async uploadFile(e){const t=e.target.files[0];if(!t)return void(this.errorMessage="Please select a file to upload.");const a=new FormData;a.append("file",t);try{const e=await P.A.post("http://localhost:5000/upload/geojson",a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});alert("File uploaded successfully!"),console.log("Response:",e.data),this.errorMessage=null}catch(o){console.error("Upload error:",o),this.errorMessage=o.response?.data?.error||"File upload failed. Please try again."}}}};const I=(0,i.A)(A,[["render",U]]);var T=I;const j={id:"controls"};function X(e,t,a,o,r,s){return(0,n.uX)(),(0,n.CE)("div",null,[t[2]||(t[2]=(0,n.Lk)("div",{id:"map",style:{height:"500px",width:"100%"}},null,-1)),(0,n.Lk)("div",j,[(0,n.Lk)("button",{id:"toggle-draw",onClick:t[0]||(t[0]=(...e)=>s.toggleDraw&&s.toggleDraw(...e))},(0,E.v_)(r.drawEnabled?"Disable Draw":"Enable Draw"),1),(0,n.Lk)("button",{id:"measure-distance",onClick:t[1]||(t[1]=(...e)=>s.enableMeasurement&&s.enableMeasurement(...e))},(0,E.v_)(r.measuring?"Stop Measurement":"Measure Distance"),1)])])}var _=a(6886),x=a.n(_),$=(a(4814),a(7024)),J=a(8249),R=a(1071);delete x().Icon.Default.prototype._getIconUrl,x().Icon.Default.mergeOptions({iconRetinaUrl:J,iconUrl:$,shadowUrl:R});var V={name:"MapView",data(){return{map:null,drawControl:null,drawnItems:null,drawEnabled:!0,measuring:!1,measureLayer:null}},mounted(){this.map=x().map("map").setView([28.6139,77.209],10),x().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(this.map),this.drawnItems=new(x().FeatureGroup),this.map.addLayer(this.drawnItems),this.drawControl=new(x().Control.Draw)({edit:{featureGroup:this.drawnItems},draw:{polygon:!0,rectangle:!0,circle:!0,marker:!0,polyline:!0}}),this.map.addControl(this.drawControl),this.map.on("draw:created",(e=>{const{layer:t}=e;this.drawnItems.addLayer(t),console.log("Shape drawn:",t.toGeoJSON())}))},methods:{toggleDraw(){this.drawEnabled?(this.map.removeControl(this.drawControl),console.log("Drawing tools disabled")):(this.map.addControl(this.drawControl),console.log("Drawing tools enabled")),this.drawEnabled=!this.drawEnabled},enableMeasurement(){this.measuring?(this.map.off("click",this.addMeasurementPoint),this.measureLayer&&(this.map.removeLayer(this.measureLayer),this.measureLayer=null),this.measuring=!1,console.log("Measurement mode disabled")):(this.measuring=!0,this.measureLayer=x().polyline([],{color:"blue"}).addTo(this.map),this.map.on("click",this.addMeasurementPoint),console.log("Measurement mode enabled"))},addMeasurementPoint(e){const t=e.latlng;this.measureLayer.addLatLng(t);const a=this.measureLayer.getLatLngs();let o=0;for(let r=1;r<a.length;r++)o+=a[r-1].distanceTo(a[r]);const n=o>=1e3?`${(o/1e3).toFixed(2)} km`:`${Math.round(o)} m`;x().popup().setLatLng(t).setContent(`Total Distance: ${n}`).openOn(this.map),console.log(`Total Distance: ${n}`)}}};const q=(0,i.A)(V,[["render",X]]);var G=q,K={components:{FileUpload:T,Map:G},data(){return{datasets:[],loading:!1}},methods:{async fetchDatasets(){this.loading=!0;try{const e=await P.A.get("http://localhost:5000/map/files",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.datasets=e.data.map((e=>({name:e.name,data:JSON.parse(e.data)})))}catch(e){console.error("Error fetching datasets:",e),alert("Failed to load datasets")}finally{this.loading=!1}}},async mounted(){await this.fetchDatasets()}};const N=(0,i.A)(K,[["render",O]]);var z=N;const B=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:y},{path:"/register",name:"Register",component:C},{path:"/dashboard",name:"Dashboard",component:z}],Q=(0,c.aE)({history:(0,c.LA)(),routes:B});var Z=Q,H=(0,g.y$)({state:{token:localStorage.getItem("token")||null,user:null},mutations:{setToken(e,t){e.token=t,localStorage.setItem("token",t)},clearToken(e){e.token=null,localStorage.removeItem("token")},setUser(e,t){e.user=t}},actions:{async login({commit:e},{email:t,password:a}){try{const o=await P.A.post("http://localhost:5000/auth/login",{email:t,password:a}),n=o.data.token;return e("setToken",n),!0}catch(o){throw console.error("Login failed:",o.response?.data||o.message),new Error("Login failed. Please check your credentials.")}},logout({commit:e}){e("clearToken")}},getters:{isAuthenticated(e){return!!e.token},getToken(e){return e.token}}});(0,o.Ef)(u).use(H).use(Z).mount("#app")}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,o,n,r){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],n=e[u][1],r=e[u][2];for(var l=!0,i=0;i<o.length;i++)(!1&r||s>=r)&&Object.keys(a.O).every((function(e){return a.O[e](o[i])}))?o.splice(i--,1):(l=!1,r<s&&(s=r));if(l){e.splice(u--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,n,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,r,s=o[0],l=o[1],i=o[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(i)var u=i(a)}for(t&&t(o);d<s.length;d++)r=s[d],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},o=self["webpackChunkgeospatial_frontend"]=self["webpackChunkgeospatial_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],(function(){return a(5998)}));o=a.O(o)})();
//# sourceMappingURL=app.7fcf4816.js.map